name: Primary Flickr to Instagram Automation
run-name: "Primary Account - ${{ github.event_name == 'schedule' && 'Scheduled' || 'Manual' }} Run (${{ github.run_number }})"

on:
  # Daily posting at 18:13 UTC (20:13 CEST)
  schedule:
    - cron: '13 18 * * *'
    # - cron: '43 09 * * *' # Posting only one Sardinia photo per day for now

  # Manual trigger with options
  workflow_dispatch:
    inputs:
      dry_run:
        description: 'Run without posting (dry run)'
        type: boolean
        default: false
      show_stats:
        description: 'Show statistics only'
        type: boolean
        default: false

# Ensure only one automation runs at a time
concurrency:
  group: social-media-automation
  cancel-in-progress: false

permissions:
  contents: read
  issues: write        # For legacy GitHub Issues (compatibility)
  actions: write       # For repository variables state management

jobs:
  automation:
    uses: ./.github/workflows/social-automation.yml
    with:
      account_id: primary
      environment_name: primary-account
      account_flag: ''  # No account flag for primary (default behavior)
      dry_run: ${{ inputs.dry_run || false }}
      show_stats: ${{ inputs.show_stats || false }}
    secrets: inherit